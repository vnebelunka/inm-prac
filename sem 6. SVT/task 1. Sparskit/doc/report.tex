\input{preamble}

\begin{document}
	\tableofcontents
	
	\section{Постановка задачи}
	
	 Используя библиотеку sparskit, нужно было решить разреженную систему матриц формата CSR.
	 
	 Необходимо установить SPARSKIT, написать код на Фортране, который подгру-
	 жает матрицу, генерирует правую часть, строит переобуславливатель ILU(k) и запускает
	 GMRES. Нужно замерить время построения переобуславливателя и время совершения итераций, а также число итераций.
	
	\begin{enumerate}
		\item Матрицы: по адресу \url{https://old.inm.ras.ru/vtm/svt/matr.tgz}
		\item Правая часть: $b_i = sin(i)$
		\item Точность GMRES: невязка должна быть уменьшена в $\epsilon = 10^{-8}$ раз.
		\item Параметр k в ILU(k) = 0.
		\item Количество крыловский пространств im в GMRES = 10.
	\end{enumerate}
	
	\section{Результаты}
	
	Время измерялось с помощью $cpu \_ time()$, код выполнялся на 8ядерном процессоре.
	
	Код запускался с флагами -flto -Ofast -march=native.
	
\begin{table}[h!]
	\centering
	\begin{tabular}{ | c | c | c | c | }
		\hline
		Размер матрицы & Время ILU(K) , с & Время GMRES, с & Итераций GMRES \\  [0.5ex]
		\hline\hline
		4127 & 0.005 &  0.046 & 315 \\
		\hline
		16527 & 0.021 & 4.856 & 584 \\
		\hline
		66159 & 0.089 & 45.498 & 1874 \\
		\hline
		264751 & 0.433 & 116.462 &  2243 \\
		\hline
	\end{tabular}
	\caption{измерения времени работы программы.}
	\label{table:1}
\end{table}
	
	\section{Выводы}
	
	Как видно из \ref{table:1}, ассимтотическая сложность ILU близка к $O(n)$.
	
	Количество итераций и, следовательно, время работы GMRES резко возрастает между 16к и 64к, что может быть связано с изменений в спектрах матриц.
	
	Видно, что время работы GMRES быстрее, чем $O(n^2)$, но дольше, чем $O(n^{\frac{4}{3}})$, равно примерно $O(n^{\frac{3}{2}})$.
	
	Количество итераций зависит от спектра матрицы и получилось примерно равно $O(n^{\frac{1}{2}})$.
	
\end{document}